<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.9.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>
<meta name="description" content="Ensemble Learning Methods">
<meta property="og:type" content="article">
<meta property="og:title" content="Ensemble Learning Methods">
<meta property="og:url" content="http://example.com/2023/03/08/Ensemble-Learning-Methods/index.html">
<meta property="og:site_name" content="Jay&#39;s Blog">
<meta property="og:description" content="Ensemble Learning Methods">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2023/03/08/Ensemble-Learning-Methods/Ensemble%20Learning%20and%20Random%20Forests.jpg">
<meta property="og:image" content="http://example.com/2023/03/08/Ensemble-Learning-Methods/Fig7-2.png">
<meta property="og:image" content="http://example.com/2023/03/08/Ensemble-Learning-Methods/output_8_0.png">
<meta property="og:image" content="http://example.com/2023/03/08/Ensemble-Learning-Methods/Fig7-4.png">
<meta property="og:image" content="http://example.com/2023/03/08/Ensemble-Learning-Methods/Fig7-7.png">
<meta property="og:image" content="http://example.com/2023/03/08/Ensemble-Learning-Methods/Fig7-8.png">
<meta property="og:image" content="http://example.com/2023/03/08/Ensemble-Learning-Methods/Fig7-9.png">
<meta property="og:image" content="http://example.com/2023/03/08/Ensemble-Learning-Methods/Fig7-10.png">
<meta property="og:image" content="http://example.com/2023/03/08/Ensemble-Learning-Methods/Fig7-12.png">
<meta property="og:image" content="http://example.com/2023/03/08/Ensemble-Learning-Methods/Fig7-13.png">
<meta property="og:image" content="http://example.com/2023/03/08/Ensemble-Learning-Methods/Fig7-14.png">
<meta property="og:image" content="http://example.com/2023/03/08/Ensemble-Learning-Methods/Fig7-15.png">
<meta property="article:published_time" content="2023-03-08T13:12:49.000Z">
<meta property="article:modified_time" content="2023-03-08T13:22:21.474Z">
<meta property="article:author" content="Gozen Sanji">
<meta property="article:tag" content="Machine Learning">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2023/03/08/Ensemble-Learning-Methods/Ensemble%20Learning%20and%20Random%20Forests.jpg">


<link rel="canonical" href="http://example.com/2023/03/08/Ensemble-Learning-Methods/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://example.com/2023/03/08/Ensemble-Learning-Methods/","path":"2023/03/08/Ensemble-Learning-Methods/","title":"Ensemble Learning Methods"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Ensemble Learning Methods | Jay's Blog</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Jay's Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">ğŸ¬</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="user fa-fw"></i>About</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="tags fa-fw"></i>Tags</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="th fa-fw"></i>Categories</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="archive fa-fw"></i>Archives</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Voting-Classifiers"><span class="nav-number">1.</span> <span class="nav-text">Voting Classifiers</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Hard-Voting-Classifier"><span class="nav-number">1.1.</span> <span class="nav-text">Hard Voting Classifier</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Imports"><span class="nav-number">1.1.1.</span> <span class="nav-text">Imports</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-Example-1"><span class="nav-number">1.1.2.</span> <span class="nav-text">Code Example 1</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Soft-Voting-Classifier"><span class="nav-number">1.2.</span> <span class="nav-text">Soft Voting Classifier</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-Example-2"><span class="nav-number">1.2.1.</span> <span class="nav-text">Code Example 2</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Bagging-and-Pasting"><span class="nav-number">2.</span> <span class="nav-text">Bagging and Pasting</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-Example-3"><span class="nav-number">2.0.1.</span> <span class="nav-text">Code Example 3</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Out-of-Bag-Evaluation"><span class="nav-number">2.1.</span> <span class="nav-text">Out-of-Bag Evaluation</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-Example-4"><span class="nav-number">2.1.1.</span> <span class="nav-text">Code Example 4</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Random-Patches-and-Random-Subspaces"><span class="nav-number">2.2.</span> <span class="nav-text">Random Patches and Random Subspaces</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Random-Forests"><span class="nav-number">2.3.</span> <span class="nav-text">Random Forests</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-Example-5-amp-6"><span class="nav-number">2.3.1.</span> <span class="nav-text">Code Example 5 &amp; 6</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Extra-Trees"><span class="nav-number">2.4.</span> <span class="nav-text">Extra-Trees</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Feature-Importance"><span class="nav-number">2.5.</span> <span class="nav-text">Feature Importance</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-Example-7"><span class="nav-number">2.5.1.</span> <span class="nav-text">Code Example 7</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Boosting"><span class="nav-number">3.</span> <span class="nav-text">Boosting</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#AdaBoost"><span class="nav-number">3.1.</span> <span class="nav-text">AdaBoost</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-Example-8"><span class="nav-number">3.1.1.</span> <span class="nav-text">Code Example 8</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Gradient-Boosting"><span class="nav-number">3.2.</span> <span class="nav-text">Gradient Boosting</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-Example-9"><span class="nav-number">3.2.1.</span> <span class="nav-text">Code Example 9</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-Example-10"><span class="nav-number">3.2.2.</span> <span class="nav-text">Code Example 10</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-Example-11"><span class="nav-number">3.2.3.</span> <span class="nav-text">Code Example 11</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-Example-12"><span class="nav-number">3.2.4.</span> <span class="nav-text">Code Example 12</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Stacking"><span class="nav-number">4.</span> <span class="nav-text">Stacking</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-Example-13"><span class="nav-number">4.0.1.</span> <span class="nav-text">Code Example 13</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Gozen Sanji"
      src="/images/my_avatar.jpg">
  <p class="site-author-name" itemprop="name">Gozen Sanji</p>
  <div class="site-description" itemprop="description">ç›®ãŒè¦šã‚ãŸæŠµæŠ— å‹è½ã¡ã®è¡å‹•</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">14</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/08/Ensemble-Learning-Methods/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/my_avatar.jpg">
      <meta itemprop="name" content="Gozen Sanji">
      <meta itemprop="description" content="ç›®ãŒè¦šã‚ãŸæŠµæŠ— å‹è½ã¡ã®è¡å‹•">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jay's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Ensemble Learning Methods
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2023-03-08 21:12:49 / Modified: 21:22:21" itemprop="dateCreated datePublished" datetime="2023-03-08T21:12:49+08:00">2023-03-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Machine-Learning/" itemprop="url" rel="index"><span itemprop="name">Machine Learning</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p><strong>Ensemble Learning Methods</strong></p>
<p><img src="/2023/03/08/Ensemble-Learning-Methods/Ensemble Learning and Random Forests.jpg" style="width: 1200px;" align="center"></p>
<span id="more"></span>
<h1 id="Voting-Classifiers"><a href="#Voting-Classifiers" class="headerlink" title="Voting Classifiers"></a>Voting Classifiers</h1><h2 id="Hard-Voting-Classifier"><a href="#Hard-Voting-Classifier" class="headerlink" title="Hard Voting Classifier"></a>Hard Voting Classifier</h2><ol>
<li>ä»¥<strong>å¾—ç¥¨æ•°æœ€é«˜</strong>çš„ç±»åˆ«æœ€ä¸ºæœ€ç»ˆé¢„æµ‹ç±»åˆ«ï¼›<br><img src="/2023/03/08/Ensemble-Learning-Methods/Fig7-2.png" style="width: 300px;" align="center"></li>
</ol>
<hr>
<ol>
<li>Remarkï¼š<ol>
<li>ç†è®ºä¸Šï¼Œåªè¦æœ‰è¶³å¤Ÿå¤šã€è¶³å¤Ÿä¸åŒçš„å¼±å­¦ä¹ å™¨ï¼Œå°†å®ƒä»¬é›†æˆåœ¨ä¸€èµ·å°±å¯èƒ½è·å¾—ä¸€ä¸ª<strong>å¼ºå­¦ä¹ å™¨</strong></li>
<li><strong>å¼±å­¦ä¹ å™¨</strong>æ˜¯æŒ‡æ¯”ççŒœå¼ºä¸€ç‚¹å„¿çš„å­¦ä¹ å™¨</li>
<li>å…³äº <strong>å°†å¼±å­¦ä¹ å™¨é›†æˆä¸ºå¼ºå­¦ä¹ å™¨</strong> çš„ç†è®ºä¸­æœ‰ä¸€ä¸ª<strong>å‡è®¾</strong>ï¼šå­¦ä¹ å™¨å¿…é¡»æ˜¯<strong>ç‹¬ç«‹çš„</strong>ï¼Œå®ƒä»¬æ‰€çŠ¯çš„é”™è¯¯äº’ä¸ç›¸å…³</li>
<li>å½“å„å­¦ä¹ å™¨åœ¨åŒä¸€æ•°æ®é›†ä¸Šè®­ç»ƒæ—¶ï¼Œè¯¥å‡è®¾å¹¶ä¸æˆç«‹</li>
<li>å½“å­¦ä¹ å™¨å°½å¯èƒ½ç›¸äº’ç‹¬ç«‹æ—¶ï¼Œé›†æˆæ–¹æ³•çš„æ•ˆæœæœ€å¥½</li>
<li>ä½¿ç”¨å®Œå…¨ä¸åŒçš„ç®—æ³•è®­ç»ƒå¾—åˆ°çš„å­¦ä¹ å™¨å…·æœ‰ <strong>å¤šæ ·æ€§</strong>ï¼Œè¿™èƒ½å¤Ÿå¢åŠ å­¦ä¹ å™¨çŠ¯ä¸åŒç±»å‹é”™è¯¯çš„æ¦‚ç‡</li>
</ol>
</li>
</ol>
<h3 id="Imports"><a href="#Imports" class="headerlink" title="Imports"></a>Imports</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.pipeline <span class="keyword">import</span> Pipeline</span><br><span class="line"><span class="keyword">from</span> sklearn.decomposition <span class="keyword">import</span> PCA</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_iris</span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_moons</span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> fetch_openml</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_squared_error</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_val_score</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> xgboost</span><br><span class="line"><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> SVC</span><br><span class="line"><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> LinearSVC</span><br><span class="line"><span class="keyword">from</span> sklearn.naive_bayes <span class="keyword">import</span> GaussianNB</span><br><span class="line"><span class="keyword">from</span> sklearn.neural_network <span class="keyword">import</span> MLPClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> VotingClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> BaggingClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> AdaBoostClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier, ExtraTreesClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> GradientBoostingRegressor, GradientBoostingClassifier</span><br></pre></td></tr></table></figure>
<h3 id="Code-Example-1"><a href="#Code-Example-1" class="headerlink" title="Code Example 1"></a>Code Example 1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. å‡†å¤‡ &amp; å±•ç¤ºæ•°æ®é›†</span></span><br><span class="line">X, y = make_moons(n_samples=<span class="number">500</span>, noise=<span class="number">0.3</span>, random_state=<span class="number">42</span>)</span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=<span class="number">42</span>)</span><br><span class="line">data = pd.DataFrame(np.c_[X, y])</span><br><span class="line">data.columns = [<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;label&#x27;</span>]</span><br><span class="line"></span><br><span class="line">sns.scatterplot(x=<span class="string">&#x27;x&#x27;</span>, y=<span class="string">&#x27;y&#x27;</span>, data=data, hue=<span class="string">&#x27;label&#x27;</span>)</span><br><span class="line">plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. åˆ›å»º &amp; è®­ç»ƒï¼ˆç¡¬ï¼‰æŠ•ç¥¨åˆ†ç±»å™¨</span></span><br><span class="line">log_clf = LogisticRegression(solver=<span class="string">&quot;lbfgs&quot;</span>, random_state=<span class="number">42</span>)</span><br><span class="line">rnd_clf = RandomForestClassifier(n_estimators=<span class="number">100</span>, random_state=<span class="number">42</span>)</span><br><span class="line">svm_clf = SVC(gamma=<span class="string">&quot;scale&quot;</span>, random_state=<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line">voting_clf = VotingClassifier(</span><br><span class="line">    estimators=[(<span class="string">&#x27;lr&#x27;</span>, log_clf), (<span class="string">&#x27;rf&#x27;</span>, rnd_clf), (<span class="string">&#x27;svc&#x27;</span>, svm_clf)],</span><br><span class="line">    voting=<span class="string">&#x27;hard&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. è®­ç»ƒ &amp; è¯„ä¼°æ¨¡å‹</span></span><br><span class="line"><span class="keyword">for</span> clf <span class="keyword">in</span> (log_clf, rnd_clf, svm_clf, voting_clf):</span><br><span class="line">    clf.fit(X_train, y_train)</span><br><span class="line">    y_pred = clf.predict(X_test)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;clf.__class__.__name__&#125;</span>: <span class="subst">&#123;<span class="built_in">round</span>(accuracy_score(y_test, y_pred), <span class="number">4</span>)&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2023/03/08/Ensemble-Learning-Methods/output_8_0.png" alt="png"></p>
<pre><code>LogisticRegression: 0.864
RandomForestClassifier: 0.896
SVC: 0.896
VotingClassifier: 0.912
</code></pre><p>Remarkï¼š</p>
<pre><code>  1. äº‹å®ä¸Šï¼Œè‹¥å°† make_moons() ä¸­çš„ noise å‚æ•°å€¼é™ä½ï¼Œä¹Ÿæœ‰å¯èƒ½å‡ºç° SVC åˆ†ç±»å‡†ç¡®ç‡æœ€é«˜çš„æƒ…å½¢
  2. å½“ N ä¸ªå­¦ä¹ å™¨ä¸­æœ‰ 1 ä¸ªçš„æ•ˆæœæ˜æ˜¾ä¼˜äºå…¶å®ƒå­¦ä¹ å™¨æ—¶ï¼Œé€šè¿‡ Voting å¾—åˆ°çš„å­¦ä¹ å™¨æœªå¿…æ€»ä¼˜äºæ‰€æœ‰åŸºç¡€å­¦ä¹ å™¨
  3. ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æŠ•ç¥¨è¿‡ç¨‹ä¸­ï¼Œæ•ˆæœæœ€å¥½çš„å­¦ä¹ å™¨å¯èƒ½ä¼šå—åˆ°å…¶å®ƒå­¦ä¹ å™¨çš„ **æ‹–ç´¯**
  4. å½“å­¦ä¹ å™¨æ•ˆæœéƒ½å·®ä¸å¤šæ—¶ï¼Œé€šå¸¸ Voting å¾—åˆ°çš„å­¦ä¹ å™¨æ•ˆæœä¼šæ›´å¥½
</code></pre><h2 id="Soft-Voting-Classifier"><a href="#Soft-Voting-Classifier" class="headerlink" title="Soft Voting Classifier"></a>Soft Voting Classifier</h2><ol>
<li><strong>è½¯æŠ•ç¥¨</strong> æ˜¯æŒ‡åœ¨æ‰€æœ‰å­¦ä¹ å™¨é¢„æµ‹çš„<strong>æ¦‚ç‡</strong>ä¸Šæ±‚å¹³å‡ï¼Œç„¶åæŒ‰æœ€é«˜å¹³å‡æ¦‚ç‡ç»™å‡ºæœ€ç»ˆé¢„æµ‹çš„é›†æˆæ–¹æ³•</li>
</ol>
<hr>
<ol>
<li>Remarkï¼š<ol>
<li>ä½¿ç”¨ soft voting éœ€ç¡®ä¿æ‰€æœ‰å­¦ä¹ å™¨éƒ½èƒ½é¢„æµ‹ç±»åˆ«æ¦‚ç‡</li>
<li>soft voting é€šå¸¸æ¯” hard voting å…·æœ‰æ›´å¥½çš„æ³›åŒ–æ€§èƒ½</li>
</ol>
</li>
</ol>
<h3 id="Code-Example-2"><a href="#Code-Example-2" class="headerlink" title="Code Example 2"></a>Code Example 2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. ä½¿ç”¨ç›¸åŒçš„æ•°æ®é›†ï¼Œä½†æ˜¯ Soft Voting</span></span><br><span class="line">log_clf = LogisticRegression(solver=<span class="string">&quot;lbfgs&quot;</span>, random_state=<span class="number">42</span>)</span><br><span class="line">rnd_clf = RandomForestClassifier(n_estimators=<span class="number">100</span>, random_state=<span class="number">42</span>)</span><br><span class="line">svm_clf = SVC(gamma=<span class="string">&quot;scale&quot;</span>, probability=<span class="literal">True</span>, random_state=<span class="number">42</span>)    <span class="comment"># probability=True å¯ä½¿ SVC è¾“å‡ºç±»æ¦‚ç‡</span></span><br><span class="line"></span><br><span class="line">voting_clf = VotingClassifier(</span><br><span class="line">    estimators=[(<span class="string">&#x27;lr&#x27;</span>, log_clf), (<span class="string">&#x27;rf&#x27;</span>, rnd_clf), (<span class="string">&#x27;svc&#x27;</span>, svm_clf)],</span><br><span class="line">    voting=<span class="string">&#x27;soft&#x27;</span>    <span class="comment"># è®¾ç½®ä¸º Soft Voting</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> clf <span class="keyword">in</span> (log_clf, rnd_clf, svm_clf, voting_clf):</span><br><span class="line">    clf.fit(X_train, y_train)</span><br><span class="line">    y_pred = clf.predict(X_test)</span><br><span class="line">    <span class="built_in">print</span>(clf.__class__.__name__, accuracy_score(y_test, y_pred))</span><br></pre></td></tr></table></figure>
<pre><code>LogisticRegression 0.864
RandomForestClassifier 0.896
SVC 0.896
VotingClassifier 0.92
</code></pre><p>Remarkï¼š</p>
<pre><code>  1. ä»ä¸Šä¾‹å‘ç°ï¼ŒSoft Voting çš„é¢„æµ‹å‡†ç¡®ç‡çš„ç¡®é«˜äº Hard Voting
  2. å³ä½¿æ˜¯ Soft Voting ä»å¯èƒ½å‡ºç° **è¢«æ‹–ç´¯** çš„ç°è±¡
</code></pre><h1 id="Bagging-and-Pasting"><a href="#Bagging-and-Pasting" class="headerlink" title="Bagging and Pasting"></a>Bagging and Pasting</h1><ol>
<li>è¦ä½¿å­¦ä¹ å™¨å…·å¤‡<strong>å¤šæ ·æ€§</strong>æœ‰ä¸¤ç§æ–¹æ³•ï¼š<ol>
<li>ä½¿ç”¨ä¸åŒæ¨¡å‹</li>
<li>åœ¨ä¸åŒéšæœºå­é›†ä¸Šè®­ç»ƒï¼ˆåŒä¸€ç§æ¨¡å‹ï¼‰</li>
<li>åŸºäº 2 çš„æ€è·¯å°±äº§ç”Ÿäº†ä¸¤ç§éšæœºå­é›†çš„<strong>æŠ½æ ·</strong>æ–¹æ³•ï¼š<ol>
<li><strong>æœ‰æ”¾å›</strong> â€”â€” <strong>Bagging</strong> </li>
<li><strong>æ— æ”¾å›</strong> â€”â€” <strong>Pasting</strong><br><img src="/2023/03/08/Ensemble-Learning-Methods/Fig7-4.png" style="width: 360px;" align="center"></li>
</ol>
</li>
</ol>
</li>
</ol>
<ol>
<li>Bagging å’Œ Pasting æ¨¡å‹çš„<strong>æ¨æ–­</strong>ï¼š<ol>
<li>åˆ†ç±»é—®é¢˜ï¼šæŠ•ç¥¨æ³•</li>
<li>å›å½’é—®é¢˜ï¼šåŠ æƒå¹³å‡</li>
<li><span class="mark">Remark</span>ï¼šåœ¨ BaggingClassifier çš„æ¨æ–­ä¸­ï¼Œæœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š<code>predict</code> å’Œ <code>predict_proba</code>ï¼š<ol>
<li>å‰è€…é»˜è®¤ä½¿ç”¨ Soft Voting é¢„æµ‹ç±»åˆ«ï¼Œä½†å½“åŸºç¡€åˆ†ç±»å™¨ä¸æ”¯æŒç±»æ¦‚ç‡å‹è¾“å‡ºæ—¶åˆ™ä½¿ç”¨ Hard Voting</li>
<li>åè€…é»˜è®¤ä½¿ç”¨ Soft Voting é¢„æµ‹ç±»æ¦‚ç‡ï¼Œä½†å½“åŸºç¡€åˆ†ç±»å™¨ä¸æ”¯æŒç±»æ¦‚ç‡å‹è¾“å‡ºæ—¶åˆ™ä½¿ç”¨ Hard Voting å¹¶æœ€ç»ˆè¾“å‡º <strong>é¢„æµ‹ç±»åˆ«é¢‘ç‡</strong> ä½œä¸ºæ¦‚ç‡çš„è¿‘ä¼¼</li>
</ol>
</li>
</ol>
</li>
</ol>
<hr>
<ol>
<li>Remarkï¼š<ol>
<li>ä»¥ bagging or pasting æ–¹æ³•å¾—åˆ°çš„å­¦ä¹ å™¨  <strong>VS</strong>  åœ¨åŸå§‹è®­ç»ƒé›†ä¸Šçš„å•ä¸ªå­¦ä¹ å™¨ï¼š<ol>
<li>ä¸¤è€… Bias ç›¸è¿‘ </li>
<li>å‰è€… Variance æ›´å°  </li>
<li>å‰è€…å¯<strong>å¹¶è¡Œåœ°</strong>è®­ç»ƒå’Œæ¨æ–­ï¼Œå› æ­¤è§„æ¨¡æ˜“äºæ‹“å±•</li>
</ol>
</li>
<li>Bagging  <strong>VS</strong>  Pasting:<ol>
<li>ä» bias è§’åº¦ï¼šbagging ç•¥å¤§äº pasting</li>
<li>ä» variance è§’åº¦ï¼šbagging ç•¥å°äº pasting</li>
<li>é€šå¸¸ bagging æ¨¡å‹æ³›åŒ–æ€§èƒ½æ›´å¥½</li>
<li>ç®—åŠ›å……è¶³æ—¶ï¼Œå¯é€šè¿‡äº¤å‰éªŒè¯æ¥ç¡®å®š bagging å’Œ pasting å“ªä¸ªæ›´é€‚åˆå½“å‰é—®é¢˜</li>
</ol>
</li>
</ol>
</li>
</ol>
<h3 id="Code-Example-3"><a href="#Code-Example-3" class="headerlink" title="Code Example 3"></a>Code Example 3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.Bagging æ¨¡å‹çš„æ„å»ºã€è®­ç»ƒå’Œé¢„æµ‹</span></span><br><span class="line">bag_clf = BaggingClassifier(</span><br><span class="line">    base_estimator=DecisionTreeClassifier(), </span><br><span class="line">    n_estimators=<span class="number">500</span>,</span><br><span class="line">    max_samples=<span class="number">100</span>, </span><br><span class="line">    bootstrap=<span class="literal">True</span>,    <span class="comment"># bootstrap=True ä¸º Baggingï¼Œå¦åˆ™ä¸º Pasting </span></span><br><span class="line">    random_state=<span class="number">42</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">bag_clf.fit(X_train, y_train)</span><br><span class="line">y_pred = bag_clf.predict(X_test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Bagging Classifier: <span class="subst">&#123;accuracy_score(y_test, y_pred)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.å•ä¸ªå†³ç­–æ ‘æ¨¡å‹çš„æ„å»ºã€è®­ç»ƒå’Œé¢„æµ‹</span></span><br><span class="line">tree_clf = DecisionTreeClassifier(random_state=<span class="number">42</span>)</span><br><span class="line">tree_clf.fit(X_train, y_train)</span><br><span class="line">y_pred_tree = tree_clf.predict(X_test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Tree Classifier: <span class="subst">&#123;accuracy_score(y_test, y_pred_tree)&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>Bagging Classifier: 0.904
Tree Classifier: 0.856
</code></pre><p>Remarkï¼š</p>
<pre><code>  1. ä»ä¸Šä¾‹å¾—åˆ°çš„**å¯ç¤º**â€”â€”é›†æˆæ¨¡å‹ä¸å•ä¸ªæ¨¡å‹ç›¸æ¯”ï¼š
     1. åå·®ç›¸è¿‘ï¼ˆè®­ç»ƒé›†ä¸­çš„ errors æ•°å·®ä¸å¤šï¼Œ&lt;span class=&quot;burk&quot;&gt;ä½†è¯´å®è¯æˆ‘è§‰å¾—æŒºå¤šçš„--!&lt;/span&gt;ï¼‰
     2. æ–¹å·®æ›´å°ï¼ˆå†³ç­–è¾¹ç•Œæ›´å¹³æ»‘ï¼Œæ³›åŒ–æ€§èƒ½å¯èƒ½æ›´å¥½ï¼‰
        &lt;img src=&quot;./Fig7-5.png&quot;  style=&quot;width: 600px;&quot;  align=&quot;center&quot;/&gt;
</code></pre><h2 id="Out-of-Bag-Evaluation"><a href="#Out-of-Bag-Evaluation" class="headerlink" title="Out-of-Bag Evaluation"></a>Out-of-Bag Evaluation</h2><ol>
<li>ç”±äº bagging çš„æŠ½æ ·æœºåˆ¶ï¼Œæ— éœ€é¢å¤–åˆ’åˆ†éªŒè¯é›†ï¼Œå³å¯åœ¨ <strong>åŒ…å¤–å®ä¾‹</strong> ä¸Šè¯„ä¼°æ¨¡å‹</li>
</ol>
<h3 id="Code-Example-4"><a href="#Code-Example-4" class="headerlink" title="Code Example 4"></a>Code Example 4</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.å¸¦åŒ…å¤–è¯„ä¼°çš„ Bagging æ¨¡å‹</span></span><br><span class="line">bag_clf = BaggingClassifier(</span><br><span class="line">    base_estimator=DecisionTreeClassifier(), </span><br><span class="line">    n_estimators=<span class="number">500</span>,</span><br><span class="line">    bootstrap=<span class="literal">True</span>, </span><br><span class="line">    oob_score=<span class="literal">True</span>,    <span class="comment"># å¼€å¯åŒ…å¤–è¯„ä¼°ï¼ˆæ³¨æ„ï¼šè¯¥å‚æ•°åœ¨ bootstrap=Falseï¼ˆå³ pastingï¼‰æ—¶ä¸å¯è®¾ä¸º Falseï¼‰</span></span><br><span class="line">    random_state=<span class="number">40</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">bag_clf.fit(X_train, y_train)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;åŒ…å¤–è¯„ä¼°å‡†ç¡®ç‡: <span class="subst">&#123;<span class="built_in">round</span>(bag_clf.oob_score_, <span class="number">4</span>)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æµ‹è¯•é›†å‡†ç¡®ç‡: <span class="subst">&#123;accuracy_score(y_test, bag_clf.predict(X_test))&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># bag_clf.oob_decision_function_</span></span><br></pre></td></tr></table></figure>
<pre><code>åŒ…å¤–è¯„ä¼°å‡†ç¡®ç‡: 0.8987
æµ‹è¯•é›†å‡†ç¡®ç‡: 0.912
</code></pre><p>Remarkï¼š</p>
<pre><code>  1. `oob_decision_function_`å¹¶éä¸€ä¸ªå‡½æ•°ï¼Œå®ƒåªæ˜¯å­˜å‚¨äº†å­¦ä¹ å™¨åœ¨åŒ…å¤–å®ä¾‹ä¸Šçš„é¢„æµ‹ç»“æœ
  2. å½“åŸºå­¦ä¹ å™¨å¯é¢„æµ‹ç±»æ¦‚ç‡æ—¶ï¼Œ`oob_decision_function_`çš„è¿”å›ç»“æœä¹Ÿå°†æ˜¯æ¯ä¸ª**è®­ç»ƒ**å®ä¾‹çš„ç±»æ¦‚ç‡
</code></pre><h2 id="Random-Patches-and-Random-Subspaces"><a href="#Random-Patches-and-Random-Subspaces" class="headerlink" title="Random Patches and Random Subspaces"></a>Random Patches and Random Subspaces</h2><ol>
<li>BaggingClassifier è¿˜æ”¯æŒ<strong>å¯¹ç‰¹å¾çš„æŠ½æ ·</strong>ï¼Œæ­¤æŠ½æ ·ç”±ä¸¤ä¸ªå‚æ•°æ§åˆ¶ï¼šmax_features &amp; bootstrap_features </li>
<li>è¿™ç§æŠ½æ ·å¯¹ç‰¹å¾æ•°åºå¤§çš„æ•°æ®é›†ï¼ˆä¾‹å¦‚å›¾åƒï¼‰éå¸¸æœ‰ç”¨ï¼Œå®ƒè¿›ä¸€æ­¥å¢åŠ äº†åŸºæ¨¡å‹çš„å¤šæ ·æ€§ï¼Œä»£ä»·åˆ™æ˜¯ä¸€ç‚¹å„¿ bias</li>
<li>ä¸åŒæŠ½æ ·ç­–ç•¥å½¢æˆä¸åŒçš„é›†æˆå­¦ä¹ æ–¹æ³•ï¼š<ol>
<li><strong>éšæœºè¡¥ä¸</strong>ï¼šåŒæ—¶å¯¹æ ·æœ¬å’Œç‰¹å¾æŠ½æ ·</li>
<li><strong>éšæœºå­ç©ºé—´</strong>ï¼šä»…å¯¹ç‰¹å¾æŠ½æ ·</li>
</ol>
</li>
</ol>
<h2 id="Random-Forests"><a href="#Random-Forests" class="headerlink" title="Random Forests"></a>Random Forests</h2><ol>
<li>ä¸å¿…é€šè¿‡ BaggingClassifier åˆ›å»ºéšæœºæ£®æ—åˆ†ç±»å™¨ï¼Œç›´æ¥ä½¿ç”¨ RandomForestClassifier æ›´æ–¹ä¾¿</li>
<li>RandomForestClassifier å¯¹å†³ç­–æ ‘ä¸“é—¨ä¼˜åŒ–è¿‡</li>
<li>RandomForest é€šå¸¸é‡‡ç”¨ bagging ç­–ç•¥ï¼Œä¸”å®ƒé»˜è®¤ä½¿ç”¨å®Œæ•´è®­ç»ƒé›†</li>
<li>éšæœºæ£®æ—å¼•è¿›äº†<strong>é¢å¤–éšæœºæ€§</strong>ï¼šåœ¨åˆ†è£‚èŠ‚ç‚¹æ—¶ï¼Œé€‰å–ä¸€ä¸ªéšæœºç‰¹å¾å­é›†ï¼Œå¹¶ä»ä¸­å¯»æ‰¾æœ€ä½³ç‰¹å¾ä»¥åˆ’åˆ†èŠ‚ç‚¹</li>
<li>ä¸Šè¿°åšæ³•è¿˜æ˜¯ç”¨ç¨é«˜çš„ Bias æ¢å–æ›´ä½çš„ Varianceï¼Œé€šå¸¸æ¨¡å‹æ•ˆæœä¹Ÿæ›´å¥½</li>
</ol>
<h3 id="Code-Example-5-amp-6"><a href="#Code-Example-5-amp-6" class="headerlink" title="Code Example 5 &amp; 6"></a>Code Example 5 &amp; 6</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.æ„å»ºå¹¶è®­ç»ƒä¸€ä¸ªéšæœºæ£®æ—åˆ†ç±»å™¨</span></span><br><span class="line">rnd_clf = RandomForestClassifier(</span><br><span class="line">    n_estimators=<span class="number">500</span>, </span><br><span class="line">    max_leaf_nodes=<span class="number">16</span>, </span><br><span class="line">    random_state=<span class="number">42</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">rnd_clf.fit(X_train, y_train)</span><br><span class="line">y_pred_rf = rnd_clf.predict(X_test)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.æ„å»ºå¹¶è®­ç»ƒäº†ä¸€ä¸ªç­‰ä»·çš„ Bagging æ¨¡å‹</span></span><br><span class="line">bag_clf = BaggingClassifier(</span><br><span class="line">    DecisionTreeClassifier(</span><br><span class="line">        max_features=<span class="string">&quot;sqrt&quot;</span>, </span><br><span class="line">        max_leaf_nodes=<span class="number">16</span></span><br><span class="line">    ),</span><br><span class="line">    n_estimators=<span class="number">500</span>, </span><br><span class="line">    random_state=<span class="number">42</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">bag_clf.fit(X_train, y_train)</span><br><span class="line">y_pred = bag_clf.predict(X_test)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.å¯¹æ¯”ä¸Šé¢ä¸¤ä¸ªæ¨¡å‹çš„æ•ˆæœï¼Œå‘ç°é¢„æµ‹ç»“æœå‡ ä¹å®Œå…¨ä¸€è‡´</span></span><br><span class="line">np.<span class="built_in">sum</span>(y_pred == y_pred_rf) / <span class="built_in">len</span>(y_pred)</span><br></pre></td></tr></table></figure>
<pre><code>1.0
</code></pre><h2 id="Extra-Trees"><a href="#Extra-Trees" class="headerlink" title="Extra-Trees"></a>Extra-Trees</h2><ol>
<li><strong>Extra-Trees</strong>ï¼šä¸æœç´¢æœ€ä½³åˆ†è£‚é˜ˆå€¼ï¼Œè€Œé‡‡å–<strong>éšæœºåˆ†è£‚</strong>çš„æ–¹å¼ï¼Œä¸ºå†³ç­–æ ‘æ·»åŠ æ›´å¤šéšæœºæ€§</li>
<li>ä¸Šè¿°ç­–ç•¥ä»æ˜¯ä»¥ç¨é«˜çš„ bias æ¢å–æ›´ä½çš„ variance</li>
<li>ç”±äºèŠ‚ç‚¹åˆ†è£‚æ–¹å¼æ˜¯éšæœºçš„ï¼Œå› æ­¤ Extra-Trees çš„<strong>è®­ç»ƒé€Ÿåº¦æ›´å¿«</strong>ï¼ˆä¸ Random Forest ç›¸æ¯”ï¼‰</li>
<li>é€šå¸¸æ— æ³•é¢„è§éšæœºæ£®æ—å’Œæç«¯éšæœºæ ‘è°çš„æ€§èƒ½æ›´å¥½ï¼Œåªæœ‰å®é™…å°è¯•ä¸¤ç§æ¨¡å‹å¹¶é€šè¿‡äº¤å‰éªŒè¯æœç´¢æœ€ä½³è¶…å‚æ•°ç»„åˆï¼Œæ‰èƒ½æœ€ç»ˆç¡®å®šæ›´é€‚åˆå½“å‰ä»»åŠ¡çš„æ¨¡å‹</li>
</ol>
<h2 id="Feature-Importance"><a href="#Feature-Importance" class="headerlink" title="Feature Importance"></a>Feature Importance</h2><ol>
<li>éšæœºæ£®æ—çš„ä¸€ä¸ªä¼˜ç‚¹ï¼šå¯æ–¹ä¾¿åœ°åº¦é‡<strong>ç‰¹å¾çš„ç›¸å¯¹é‡è¦æ€§</strong></li>
<li>æ‰€æœ‰ç‰¹å¾çš„é‡è¦æ€§ä¹‹å’Œç­‰äº 1</li>
<li>æ³¨ï¼š<strong>æ’åˆ—é‡è¦æ€§</strong> å’Œ <strong>SHAP</strong> èƒ½æ›´å¥½åœ°å¯¹ç‰¹å¾é‡è¦æ€§åšå‡ºåˆ†æ</li>
</ol>
<h3 id="Code-Example-7"><a href="#Code-Example-7" class="headerlink" title="Code Example 7"></a>Code Example 7</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.åŸºäºé¸¢å°¾èŠ±æ•°æ®é›†æ„å»ºéšæœºæ£®æ—åˆ†ç±»å™¨</span></span><br><span class="line">iris = load_iris()</span><br><span class="line">rnd_clf = RandomForestClassifier(</span><br><span class="line">    n_estimators=<span class="number">500</span>, </span><br><span class="line">    random_state=<span class="number">42</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">rnd_clf.fit(iris[<span class="string">&quot;data&quot;</span>], iris[<span class="string">&quot;target&quot;</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.ç‰¹å¾é‡è¦æ€§</span></span><br><span class="line"><span class="keyword">for</span> name, score <span class="keyword">in</span> <span class="built_in">zip</span>(iris[<span class="string">&quot;feature_names&quot;</span>], rnd_clf.feature_importances_):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;name&#125;</span> çš„ç‰¹å¾é‡è¦æ€§åˆ†æ•°ï¼š<span class="subst">&#123;<span class="built_in">round</span>(score, <span class="number">4</span>)&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>sepal length (cm) çš„ç‰¹å¾é‡è¦æ€§åˆ†æ•°ï¼š0.1125
sepal width (cm) çš„ç‰¹å¾é‡è¦æ€§åˆ†æ•°ï¼š0.0231
petal length (cm) çš„ç‰¹å¾é‡è¦æ€§åˆ†æ•°ï¼š0.441
petal width (cm) çš„ç‰¹å¾é‡è¦æ€§åˆ†æ•°ï¼š0.4234
</code></pre><h1 id="Boosting"><a href="#Boosting" class="headerlink" title="Boosting"></a>Boosting</h1><ol>
<li>Boosting çš„æ ¸å¿ƒæƒ³æ³•ï¼š<strong>åºåˆ—å¼</strong>åœ°è®­ç»ƒä¸€ç³»åˆ—é¢„æµ‹å™¨ï¼Œæ¯ä¸€ä¸ªéƒ½å°è¯•ä¿®æ­£å‰ä¸€ä¸ªé¢„æµ‹å™¨æ‰€çŠ¯é”™è¯¯</li>
<li>è¯´ç™½äº†å°±æ˜¯ä¸æ–­é€¼è¿‘ç›®æ ‡å€¼ or ä¸æ–­ä¿®æ­£è¯¯å·®çš„æ–¹æ³•</li>
<li>ç›®å‰æœ€ä¸»æµçš„ä¸¤ä¸ª Boosting æ–¹æ³•ï¼š <ol>
<li>AdaBoost</li>
<li>Gradient Boosting</li>
</ol>
</li>
</ol>
<h2 id="AdaBoost"><a href="#AdaBoost" class="headerlink" title="AdaBoost"></a>AdaBoost</h2><ol>
<li><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼ˆä»¥åˆ†ç±»å™¨è§’åº¦ä¸¾ä¾‹ï¼‰ï¼š<ol>
<li>å¯¹åˆ†ç±»å™¨  <strong>è¯¯åˆ†ç±»çš„å®ä¾‹</strong>  å¢åŠ æƒé‡</li>
<li>åœ¨æ›´æ–°æƒé‡åçš„è®­ç»ƒé›†ä¸Šè®­ç»ƒä¸‹ä¸€ä¸ªåˆ†ç±»å™¨</li>
<li>ä¸æ–­è¿­ä»£ï¼ˆè®­ç»ƒã€é¢„æµ‹ã€æ›´æ–°æƒé‡ã€è®­ç»ƒã€é¢„æµ‹ã€æ›´æ–°æƒé‡ã€â€¦â€¦ï¼‰ï¼Œä»è€Œæ–°åˆ†ç±»å™¨å°†æ›´å…³æ³¨é‚£äº›  <strong>è¾ƒéš¾åˆ†ç±»çš„å®ä¾‹</strong><br><img src="/2023/03/08/Ensemble-Learning-Methods/Fig7-7.png" style="width: 400px;" align="center"></li>
</ol>
</li>
</ol>
<ol>
<li>ä¸åŒ<strong>å­¦ä¹ ç‡</strong>å¯¹ AdaBoost å†³ç­–è¾¹ç•Œçš„å½±å“ï¼š<ol>
<li>è¾ƒå¤§çš„å­¦ä¹ ç‡ï¼šå†³ç­–è¾¹ç•Œå˜åŠ¨å‰§çƒˆ</li>
<li>è¾ƒå°çš„å­¦ä¹ ç‡ï¼šå†³ç­–è¾¹ç•Œå˜åŠ¨ç¼“å’Œ<br><img src="/2023/03/08/Ensemble-Learning-Methods/Fig7-8.png" style="width: 500px;" align="center"></li>
</ol>
</li>
</ol>
<ol>
<li><strong>æ¨æ–­æ–¹å¼</strong>ï¼š<ol>
<li>åˆ†ç±»é—®é¢˜ï¼š<strong>ç±»ä¼¼æŠ•ç¥¨æ³•</strong></li>
<li>å›å½’é—®é¢˜ï¼šåŠ æƒå¹³å‡</li>
<li>AdaBoost ä½¿ç”¨æ‰€æœ‰å­¦ä¹ å™¨å¯¹æ–°å®ä¾‹è¿›è¡Œé¢„æµ‹ï¼Œç„¶åæŒ‰<strong>æ¯ä¸ªå­¦ä¹ å™¨çš„æƒé‡</strong>å¯¹é¢„æµ‹ç»“æœè¿›è¡ŒåŠ æƒï¼Œå³å¾—æœ€ç»ˆé¢„æµ‹ç»“æœ</li>
<li><span class="mark">Remark</span>ï¼šåˆ†ç±»é—®é¢˜çš„æ¨æ–­æ–¹å¼ä¸å†åŒºåˆ† Hard / Soft Votingï¼Œè€Œæ˜¯åœ¨ <code>AdaBoostClassifier</code> ä¸­ç»™å‡ºäº†ä¸¤ç§æ–¹æ³•ï¼š<code>predict</code> å’Œ <code>predict_proba</code></li>
</ol>
</li>
</ol>
<ol>
<li>Remarkï¼š<ol>
<li>ç”±äº AdaBoost çš„<strong>åºåˆ—å¼è®­ç»ƒæ–¹å¼</strong>ï¼Œå®ƒéš¾ä»¥è¢«<strong>å¹¶è¡ŒåŒ–</strong>å¤„ç†</li>
<li>AdaBoost <strong>è®­ç»ƒåœæ­¢æ¡ä»¶</strong>ï¼š<ol>
<li>å­¦ä¹ å™¨ä¸ªæ•°è¾¾åˆ°ä¸Šé™</li>
<li>å¾—åˆ°äº†å®Œç¾çš„å­¦ä¹ å™¨</li>
</ol>
</li>
<li>é˜²æ­¢è¿‡æ‹Ÿåˆã®æªæ–½ï¼š<ol>
<li>å‡å°‘åŸºå­¦ä¹ å™¨æ•°é‡</li>
<li>ä½¿ç”¨å¸¦å¼ºæ­£åˆ™åŒ–çš„åŸºå­¦ä¹ å™¨</li>
</ol>
</li>
</ol>
</li>
</ol>
<h3 id="Code-Example-8"><a href="#Code-Example-8" class="headerlink" title="Code Example 8"></a>Code Example 8</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.æ„å»ºå¹¶è®­ç»ƒ AdaBoost åˆ†ç±»å™¨</span></span><br><span class="line">ada_clf = AdaBoostClassifier(</span><br><span class="line">    base_estimator=DecisionTreeClassifier(max_depth=<span class="number">1</span>), </span><br><span class="line">    n_estimators=<span class="number">200</span>,</span><br><span class="line">    algorithm=<span class="string">&quot;SAMME.R&quot;</span>, </span><br><span class="line">    learning_rate=<span class="number">0.5</span>, </span><br><span class="line">    random_state=<span class="number">42</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">ada_clf.fit(X_train, y_train)</span><br></pre></td></tr></table></figure>
<p><style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable<strong>label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable</strong>label-arrow:before {content: â€œâ–¸â€;float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable<strong>label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable</strong>label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable<strong>content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable</strong>content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable<strong>control:checked~div.sk-toggleable</strong>content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable<strong>control:checked~label.sk-toggleable</strong>label-arrow:before {content: â€œâ–¾â€;}#sk-container-id-1 div.sk-estimator input.sk-toggleable<strong>control:checked~label.sk-toggleable</strong>label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable<strong>control:checked~label.sk-toggleable</strong>label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hiddenâ€”visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: â€œâ€;width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: â€œâ€;position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: â€œâ€;position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/<em> jupyterâ€™s <code>normalize.less</code> sets <code>[hidden] &#123; display: none; &#125;</code> but bootstrap.min.css set <code>[hidden] &#123; display: none !important; &#125;</code> so we also need the <code>!important</code> here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: <a target="_blank" rel="noopener" href="https://github.com/scikit-learn/scikit-learn/issues/21755">https://github.com/scikit-learn/scikit-learn/issues/21755</a> </em>/display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>AdaBoostClassifier(base_estimator=DecisionTreeClassifier(max_depth=1),</pre></div></div></p>
<pre><code>               learning_rate=0.5, n_estimators=200, random_state=42)&lt;/pre&gt;&lt;b&gt;In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. &lt;br /&gt;On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;sk-container&quot; hidden&gt;&lt;div class=&quot;sk-item sk-dashed-wrapped&quot;&gt;&lt;div class=&quot;sk-label-container&quot;&gt;&lt;div class=&quot;sk-label sk-toggleable&quot;&gt;&lt;input class=&quot;sk-toggleable__control sk-hidden--visually&quot; id=&quot;sk-estimator-id-1&quot; type=&quot;checkbox&quot; &gt;&lt;label for=&quot;sk-estimator-id-1&quot; class=&quot;sk-toggleable__label sk-toggleable__label-arrow&quot;&gt;AdaBoostClassifier&lt;/label&gt;&lt;div class=&quot;sk-toggleable__content&quot;&gt;&lt;pre&gt;AdaBoostClassifier(base_estimator=DecisionTreeClassifier(max_depth=1),
               learning_rate=0.5, n_estimators=200, random_state=42)&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;sk-parallel&quot;&gt;&lt;div class=&quot;sk-parallel-item&quot;&gt;&lt;div class=&quot;sk-item&quot;&gt;&lt;div class=&quot;sk-label-container&quot;&gt;&lt;div class=&quot;sk-label sk-toggleable&quot;&gt;&lt;input class=&quot;sk-toggleable__control sk-hidden--visually&quot; id=&quot;sk-estimator-id-2&quot; type=&quot;checkbox&quot; &gt;&lt;label for=&quot;sk-estimator-id-2&quot; class=&quot;sk-toggleable__label sk-toggleable__label-arrow&quot;&gt;base_estimator: DecisionTreeClassifier&lt;/label&gt;&lt;div class=&quot;sk-toggleable__content&quot;&gt;&lt;pre&gt;DecisionTreeClassifier(max_depth=1)&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;sk-serial&quot;&gt;&lt;div class=&quot;sk-item&quot;&gt;&lt;div class=&quot;sk-estimator sk-toggleable&quot;&gt;&lt;input class=&quot;sk-toggleable__control sk-hidden--visually&quot; id=&quot;sk-estimator-id-3&quot; type=&quot;checkbox&quot; &gt;&lt;label for=&quot;sk-estimator-id-3&quot; class=&quot;sk-toggleable__label sk-toggleable__label-arrow&quot;&gt;DecisionTreeClassifier&lt;/label&gt;&lt;div class=&quot;sk-toggleable__content&quot;&gt;&lt;pre&gt;DecisionTreeClassifier(max_depth=1)&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;
</code></pre><h2 id="Gradient-Boosting"><a href="#Gradient-Boosting" class="headerlink" title="Gradient Boosting"></a>Gradient Boosting</h2><ol>
<li><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼š<ol>
<li>Gradient Boosting ä¹Ÿæ˜¯<strong>åºåˆ—å¼</strong>åœ°è®­ç»ƒä¸€ç³»åˆ—å­¦ä¹ å™¨</li>
<li>ä¸ AdaBoost çš„åŒºåˆ«ï¼šGradient Boosting ä¸­çš„æ¯ä¸ªå­¦ä¹ å™¨éƒ½æ˜¯å¯¹å‰ä¸€ä¸ªå­¦ä¹ å™¨çš„ <strong>æ®‹å·®</strong> è¿›è¡Œæ‹Ÿåˆ</li>
</ol>
</li>
</ol>
<ol>
<li><strong>æ¨æ–­æ–¹æ³•</strong>ï¼šåœ¨æ–°å®ä¾‹ä¸Šå°†æ¯ä¸ªå­¦ä¹ å™¨çš„é¢„æµ‹ç»“æœ<strong>æ±‚å’Œ</strong><br><img src="/2023/03/08/Ensemble-Learning-Methods/Fig7-9.png" style="width: 600px;" align="center"></li>
</ol>
<ol>
<li>Gradient Boosting ä¸­çš„<strong>å­¦ä¹ ç‡</strong>ï¼š<ol>
<li>å–å€¼å¾ˆå°æ—¶ï¼Œéœ€è¦æ›´å¤šæ ‘æ¥æ‹Ÿåˆè®­ç»ƒé›†ï¼Œä½†æ³›åŒ–æ€§èƒ½é€šå¸¸æ›´å¥½</li>
<li>ä¸‹å›¾æ¯”è¾ƒäº†æ ‘å¤ªå¤š / å¤ªå°‘çš„æƒ…å†µ</li>
<li><img src="/2023/03/08/Ensemble-Learning-Methods/Fig7-10.png" style="width: 600px;" align="center"></li>
</ol>
</li>
</ol>
<ol>
<li>é’ˆå¯¹è®¾å®šå¥½å­¦ä¹ ç‡çš„ Gradient Boosting æ¨¡å‹<strong>é€‰å–æœ€ä½³æ ‘æ•°é‡</strong>çš„æ–¹æ³•ï¼š<ol>
<li>ä½¿ç”¨è¿‡é‡çš„æ ‘å»ºæ¨¡å¹¶è®­ç»ƒ</li>
<li>åœ¨éªŒè¯è¿‡ç¨‹ä¸­é€šè¿‡ <strong>æå‰åœæ­¢</strong> æ‰¾åˆ°æœ€ä½³æ ‘æ•°é‡</li>
<li>Code Example 10</li>
</ol>
</li>
</ol>
<ol>
<li><p>å®ç°æå‰åœæ­¢çš„å¦ä¸€ç§æ€è·¯ï¼š</p>
<ol>
<li><strong>å¢é‡å¼è®­ç»ƒ</strong></li>
<li>Code Example 11</li>
</ol>
</li>
<li><p><strong>éšæœºæ¢¯åº¦æå‡</strong>ï¼š</p>
<ol>
<li>åœ¨ Gradient Boosting ä¸­ï¼Œä½¿æ¯ä¸ªå­¦ä¹ å™¨åŸºäº <strong>å®Œæ•´è®­ç»ƒé›†çš„ä¸€ä¸ªéšæœºå­é›†</strong> æ‹Ÿåˆæ®‹å·®</li>
<li>é€šè¿‡è®¾ç½® subsample è¶…å‚æ•°å®ç°</li>
<li>å¥½å¤„ï¼š<ol>
<li>ç”¨é«˜ä¸€ç‚¹å„¿çš„åå·®æ¢å–æ›´ä½çš„æ–¹å·®ï¼Œå¢åŠ æ¨¡å‹æ³›åŒ–æ€§èƒ½</li>
<li>åŠ å¿«è®­ç»ƒé€Ÿåº¦</li>
</ol>
</li>
</ol>
</li>
</ol>
<ol>
<li>Remarkï¼š<ol>
<li>Gradient Boosting æ¨¡å‹ä¸­å¯è‡ªå®šä¹‰æŸå¤±å‡½æ•°</li>
<li><strong>XGBoost</strong>ï¼šGradient Boosting çš„ä¸€ä¸ªä¼˜åŒ–å®ç° â€”â€” Code Example 12</li>
</ol>
</li>
</ol>
<h3 id="Code-Example-9"><a href="#Code-Example-9" class="headerlink" title="Code Example 9"></a>Code Example 9</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 0.å‡†å¤‡æ•°æ®é›†</span></span><br><span class="line">np.random.seed(<span class="number">42</span>)</span><br><span class="line">X = np.random.rand(<span class="number">100</span>, <span class="number">1</span>) - <span class="number">0.5</span></span><br><span class="line">y = <span class="number">3</span>*X[:, <span class="number">0</span>]**<span class="number">2</span> + <span class="number">0.05</span> * np.random.randn(<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.æ„å»ºå¹¶è®­ç»ƒä¸€ä¸ª GradientBoosting å›å½’å™¨</span></span><br><span class="line">gbrt = GradientBoostingRegressor(</span><br><span class="line">    max_depth=<span class="number">2</span>, </span><br><span class="line">    n_estimators=<span class="number">3</span>, </span><br><span class="line">    learning_rate=<span class="number">1.0</span>, </span><br><span class="line">    random_state=<span class="number">42</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">gbrt.fit(X, y)</span><br></pre></td></tr></table></figure>
<p><style>#sk-container-id-2 {color: black;background-color: white;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable<strong>label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable</strong>label-arrow:before {content: â€œâ–¸â€;float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable<strong>label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable</strong>label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable<strong>content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable</strong>content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable<strong>control:checked~div.sk-toggleable</strong>content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable<strong>control:checked~label.sk-toggleable</strong>label-arrow:before {content: â€œâ–¾â€;}#sk-container-id-2 div.sk-estimator input.sk-toggleable<strong>control:checked~label.sk-toggleable</strong>label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable<strong>control:checked~label.sk-toggleable</strong>label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hiddenâ€”visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: â€œâ€;width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: â€œâ€;position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: â€œâ€;position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/<em> jupyterâ€™s <code>normalize.less</code> sets <code>[hidden] &#123; display: none; &#125;</code> but bootstrap.min.css set <code>[hidden] &#123; display: none !important; &#125;</code> so we also need the <code>!important</code> here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: <a target="_blank" rel="noopener" href="https://github.com/scikit-learn/scikit-learn/issues/21755">https://github.com/scikit-learn/scikit-learn/issues/21755</a> </em>/display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GradientBoostingRegressor(learning_rate=1.0, max_depth=2, n_estimators=3,</pre></div></div></p>
<pre><code>                      random_state=42)&lt;/pre&gt;&lt;b&gt;In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. &lt;br /&gt;On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;sk-container&quot; hidden&gt;&lt;div class=&quot;sk-item&quot;&gt;&lt;div class=&quot;sk-estimator sk-toggleable&quot;&gt;&lt;input class=&quot;sk-toggleable__control sk-hidden--visually&quot; id=&quot;sk-estimator-id-4&quot; type=&quot;checkbox&quot; checked&gt;&lt;label for=&quot;sk-estimator-id-4&quot; class=&quot;sk-toggleable__label sk-toggleable__label-arrow&quot;&gt;GradientBoostingRegressor&lt;/label&gt;&lt;div class=&quot;sk-toggleable__content&quot;&gt;&lt;pre&gt;GradientBoostingRegressor(learning_rate=1.0, max_depth=2, n_estimators=3,
                      random_state=42)&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;
</code></pre><h3 id="Code-Example-10"><a href="#Code-Example-10" class="headerlink" title="Code Example 10"></a>Code Example 10</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.è®¾ç½®è¿‡é‡çš„æ ‘æ¥è®­ç»ƒ</span></span><br><span class="line">X_train, X_val, y_train, y_val = train_test_split(X, y, random_state=<span class="number">49</span>)</span><br><span class="line"></span><br><span class="line">gbrt = GradientBoostingRegressor(</span><br><span class="line">    max_depth=<span class="number">2</span>, </span><br><span class="line">    n_estimators=<span class="number">120</span>, </span><br><span class="line">    random_state=<span class="number">42</span></span><br><span class="line">)</span><br><span class="line">gbrt.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.åŸºäºéªŒè¯é›†å¯»æ‰¾æœ€ä½³æ ‘æ•°é‡</span></span><br><span class="line">errors = [mean_squared_error(y_val, y_pred) <span class="keyword">for</span> y_pred <span class="keyword">in</span> gbrt.staged_predict(X_val)]    <span class="comment"># staged_predict</span></span><br><span class="line">bst_n_estimators = np.argmin(errors) + <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æœ€ä½³æ ‘æ•°é‡ï¼š<span class="subst">&#123;bst_n_estimators&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.ä»¥æœ€ä½³æ ‘æ•°é‡é‡æ–°å»ºæ¨¡ã€è®­ç»ƒ</span></span><br><span class="line">gbrt_best = GradientBoostingRegressor(</span><br><span class="line">    max_depth=<span class="number">2</span>, </span><br><span class="line">    n_estimators=bst_n_estimators,    <span class="comment"># æœ€ä½³æ ‘æ•°é‡</span></span><br><span class="line">    random_state=<span class="number">42</span></span><br><span class="line">)</span><br><span class="line">gbrt_best.fit(X_train, y_train)</span><br></pre></td></tr></table></figure>
<pre><code>æœ€ä½³æ ‘æ•°é‡ï¼š56
</code></pre><p><style>#sk-container-id-3 {color: black;background-color: white;}#sk-container-id-3 pre{padding: 0;}#sk-container-id-3 div.sk-toggleable {background-color: white;}#sk-container-id-3 label.sk-toggleable<strong>label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-3 label.sk-toggleable</strong>label-arrow:before {content: â€œâ–¸â€;float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-3 label.sk-toggleable<strong>label-arrow:hover:before {color: black;}#sk-container-id-3 div.sk-estimator:hover label.sk-toggleable</strong>label-arrow:before {color: black;}#sk-container-id-3 div.sk-toggleable<strong>content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-3 div.sk-toggleable</strong>content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-3 input.sk-toggleable<strong>control:checked~div.sk-toggleable</strong>content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-3 input.sk-toggleable<strong>control:checked~label.sk-toggleable</strong>label-arrow:before {content: â€œâ–¾â€;}#sk-container-id-3 div.sk-estimator input.sk-toggleable<strong>control:checked~label.sk-toggleable</strong>label {background-color: #d4ebff;}#sk-container-id-3 div.sk-label input.sk-toggleable<strong>control:checked~label.sk-toggleable</strong>label {background-color: #d4ebff;}#sk-container-id-3 input.sk-hiddenâ€”visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-3 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-3 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-3 div.sk-parallel-item::after {content: â€œâ€;width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-serial::before {content: â€œâ€;position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-3 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-3 div.sk-item {position: relative;z-index: 1;}#sk-container-id-3 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-3 div.sk-item::before, #sk-container-id-3 div.sk-parallel-item::before {content: â€œâ€;position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-3 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-3 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-3 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-3 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-3 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-3 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-3 div.sk-label-container {text-align: center;}#sk-container-id-3 div.sk-container {/<em> jupyterâ€™s <code>normalize.less</code> sets <code>[hidden] &#123; display: none; &#125;</code> but bootstrap.min.css set <code>[hidden] &#123; display: none !important; &#125;</code> so we also need the <code>!important</code> here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: <a target="_blank" rel="noopener" href="https://github.com/scikit-learn/scikit-learn/issues/21755">https://github.com/scikit-learn/scikit-learn/issues/21755</a> </em>/display: inline-block !important;position: relative;}#sk-container-id-3 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-3" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GradientBoostingRegressor(max_depth=2, n_estimators=56, random_state=42)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox" checked><label for="sk-estimator-id-5" class="sk-toggleable__label sk-toggleable__label-arrow">GradientBoostingRegressor</label><div class="sk-toggleable__content"><pre>GradientBoostingRegressor(max_depth=2, n_estimators=56, random_state=42)</pre></div>&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</div></div></div></div></p>
<p>Remarkï¼š</p>
<pre><code>  1. éªŒè¯è¯¯å·® vs æ ‘æ•°é‡
  2. æœ€ä½³æ ‘æ•°é‡ä¸‹çš„ GradientBoosting æ¨¡å‹
     &lt;img src=&quot;./Fig7-11.png&quot;  style=&quot;width: 600px;&quot;  align=&quot;center&quot;/&gt;
</code></pre><h3 id="Code-Example-11"><a href="#Code-Example-11" class="headerlink" title="Code Example 11"></a>Code Example 11</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.æ„å»º GradientBoosting æ¨¡å‹</span></span><br><span class="line">gbrt = GradientBoostingRegressor(</span><br><span class="line">    max_depth=<span class="number">2</span>, </span><br><span class="line">    warm_start=<span class="literal">True</span>,    <span class="comment"># warm_start=True  </span></span><br><span class="line">    random_state=<span class="number">42</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.åˆå§‹åŒ–éªŒè¯è¯¯å·® &amp; æ¯æ¬¡è¿­ä»£éƒ½è®­ç»ƒæ¨¡å‹å¹¶è®¡ç®—éªŒè¯è¯¯å·®</span></span><br><span class="line">min_val_error = <span class="built_in">float</span>(<span class="string">&quot;inf&quot;</span>)</span><br><span class="line">error_going_up = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> n_estimators <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">120</span>):</span><br><span class="line">    gbrt.n_estimators = n_estimators    <span class="comment"># æ¯æ¬¡è¿­ä»£æ›´æ–°æ ‘æ•°é‡</span></span><br><span class="line">    gbrt.fit(X_train, y_train)</span><br><span class="line">    y_pred = gbrt.predict(X_val)</span><br><span class="line">    val_error = mean_squared_error(y_val, y_pred)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3.æ£€éªŒéªŒè¯è¯¯å·®æ˜¯å¦ä¸‹é™ </span></span><br><span class="line">    <span class="keyword">if</span> val_error &lt; min_val_error:</span><br><span class="line">        min_val_error = val_error</span><br><span class="line">        error_going_up = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        error_going_up += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> error_going_up == <span class="number">5</span>:    <span class="comment"># early stopping with patience = 5</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æœ€ä½³æ ‘æ•°é‡ï¼š<span class="subst">&#123;gbrt.n_estimators&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æœ€ä½éªŒè¯è¯¯å·®ï¼š<span class="subst">&#123;<span class="built_in">round</span>(min_val_error, <span class="number">4</span>)&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>æœ€ä½³æ ‘æ•°é‡ï¼š61
æœ€ä½éªŒè¯è¯¯å·®ï¼š0.0027
</code></pre><h3 id="Code-Example-12"><a href="#Code-Example-12" class="headerlink" title="Code Example 12"></a>Code Example 12</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.åœ¨æ•´ä¸ªè®­ç»ƒé›†ä¸Šæ‹Ÿåˆ XGBoost</span></span><br><span class="line">xgb_reg = xgboost.XGBRegressor(random_state=<span class="number">42</span>)</span><br><span class="line">xgb_reg.fit(X_train, y_train)</span><br><span class="line">y_pred = xgb_reg.predict(X_val)</span><br><span class="line">val_error = mean_squared_error(y_val, y_pred)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;åœ¨æ•´ä¸ªè®­ç»ƒé›†ä¸Šæ‹Ÿåˆ XGBoost æ—¶çš„éªŒè¯è¯¯å·®ï¼š<span class="subst">&#123;<span class="built_in">round</span>(val_error, <span class="number">4</span>)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.åŸºäºæå‰åœæ­¢è®­ç»ƒ XGBoost</span></span><br><span class="line">xgb_reg = xgboost.XGBRegressor(</span><br><span class="line">    early_stopping_rounds=<span class="number">2</span>,    <span class="comment"># patience = 2 </span></span><br><span class="line">    random_state=<span class="number">42</span></span><br><span class="line">)</span><br><span class="line">xgb_reg.fit(</span><br><span class="line">    X_train, y_train,</span><br><span class="line">    eval_set=[(X_val, y_val)],    <span class="comment"># éªŒè¯é›†</span></span><br><span class="line">)</span><br><span class="line">y_pred = xgb_reg.predict(X_val)</span><br><span class="line">val_error = mean_squared_error(y_val, y_pred)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;åŸºäºæå‰åœæ­¢æ‹Ÿåˆ XGBoost æ—¶çš„éªŒè¯è¯¯å·®ï¼š<span class="subst">&#123;<span class="built_in">round</span>(val_error, <span class="number">4</span>)&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>åœ¨æ•´ä¸ªè®­ç»ƒé›†ä¸Šæ‹Ÿåˆ XGBoost æ—¶çš„éªŒè¯è¯¯å·®ï¼š0.004
[0]    validation_0-rmse:0.22834
[1]    validation_0-rmse:0.16224
[2]    validation_0-rmse:0.11843
[3]    validation_0-rmse:0.08760
[4]    validation_0-rmse:0.06848
[5]    validation_0-rmse:0.05709
[6]    validation_0-rmse:0.05297
[7]    validation_0-rmse:0.05129
[8]    validation_0-rmse:0.05155
åŸºäºæå‰åœæ­¢æ‹Ÿåˆ XGBoost æ—¶çš„éªŒè¯è¯¯å·®ï¼š0.0026
</code></pre><h1 id="Stacking"><a href="#Stacking" class="headerlink" title="Stacking"></a>Stacking</h1><ol>
<li><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼š<ol>
<li>ä¸å†ä½¿ç”¨ç®€å•å‡½æ•°è¿›è¡Œèšåˆï¼ˆä¾‹å¦‚ hard votingï¼‰</li>
<li>è€Œæ˜¯è®­ç»ƒä¸€ä¸ªæ¨¡å‹æ¥èšåˆåŸºå­¦ä¹ å™¨çš„é¢„æµ‹ç»“æœ</li>
<li>è¿™æ˜¯ä¸€ç§<strong>å¤åˆå‡½æ•°</strong>ï¼Œåªä¸è¿‡å¤–å±‚å‡½æ•°æ˜¯ç”±æ¨¡å‹æ‹Ÿåˆå¾—åˆ°çš„</li>
</ol>
</li>
</ol>
<ol>
<li><strong>æ¨æ–­æ–¹æ³•</strong>ï¼š<ol>
<li>å…ˆç”±åŸºå­¦ä¹ å™¨å¯¹æ–°å®ä¾‹è¿›è¡Œé¢„æµ‹</li>
<li><strong>å…ƒå­¦ä¹ å™¨</strong>å†åŸºäºè¿™äº›é¢„æµ‹å€¼é¢„æµ‹å‡ºæœ€ç»ˆç»“æœ</li>
<li>å…ƒå­¦ä¹ å™¨ï¼šå³ Stacking çš„å¤–å±‚èšåˆå‡½æ•°<br><img src="/2023/03/08/Ensemble-Learning-Methods/Fig7-12.png" style="width: 500px;" align="center"></li>
</ol>
</li>
</ol>
<ol>
<li><strong>è®­ç»ƒæ–¹æ³•</strong>ï¼š<ol>
<li>å°†åˆå§‹è®­ç»ƒé›†åˆ’åˆ†ä¸ºä¸¤éƒ¨åˆ† A å’Œ B</li>
<li>åœ¨å­é›† A ä¸Šè®­ç»ƒåŸºå­¦ä¹ å™¨</li>
<li>ä»¥è®­ç»ƒå¥½çš„åŸºå­¦ä¹ å™¨åœ¨å­é›† B ä¸Šé¢„æµ‹ï¼Œå¾—åˆ°å­é›† C</li>
<li>åœ¨å­é›† C ä¸Šè®­ç»ƒå…ƒå­¦ä¹ å™¨<br><img src="/2023/03/08/Ensemble-Learning-Methods/Fig7-13.png" style="width: 500px;" align="center"><br><img src="/2023/03/08/Ensemble-Learning-Methods/Fig7-14.png" style="width: 500px;" align="center"></li>
</ol>
</li>
</ol>
<ol>
<li>æ›´è¿›ä¸€æ­¥ï¼Œå…ƒå­¦ä¹ å™¨å¯ä»¥å½¢æˆä¸€ä¸ªä¸­é—´å±‚ï¼š<br><img src="/2023/03/08/Ensemble-Learning-Methods/Fig7-15.png" style="width: 500px;" align="center"></li>
</ol>
<h3 id="Code-Example-13"><a href="#Code-Example-13" class="headerlink" title="Code Example 13"></a>Code Example 13</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 0.è¯»å–æ•°æ®é›†</span></span><br><span class="line">mnist = fetch_openml(<span class="string">&#x27;mnist_784&#x27;</span>, version=<span class="number">1</span>, as_frame=<span class="literal">False</span>)</span><br><span class="line">mnist.target = mnist.target.astype(np.uint8)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.åˆ’åˆ†è®­ç»ƒã€éªŒè¯ã€æµ‹è¯•é›†</span></span><br><span class="line">X_train_val, X_test, y_train_val, y_test = train_test_split(mnist.data, mnist.target, test_size=<span class="number">10000</span>, random_state=<span class="number">42</span>)</span><br><span class="line">X_train, X_val, y_train, y_val = train_test_split(X_train_val, y_train_val, test_size=<span class="number">10000</span>, random_state=<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.5ç®€åŒ–æ•°æ®é›†</span></span><br><span class="line">pca = PCA(n_components=<span class="number">0.90</span>)</span><br><span class="line">pca.fit_transform(X_train)</span><br><span class="line">pca.transform(X_val)</span><br><span class="line">pca.transform(X_test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;é™ç»´åï¼Œæ•°æ®é›†ç»´æ•°ï¼š<span class="subst">&#123;pca.n_components_&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-&#x27;</span> * <span class="number">63</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.æ„å»ºä¸åŒåˆ†ç±»å™¨</span></span><br><span class="line">clf_1 = Pipeline([(<span class="string">&#x27;rdf&#x27;</span>, RandomForestClassifier(n_estimators=<span class="number">100</span>, random_state=<span class="number">42</span>))])</span><br><span class="line">clf_2 = Pipeline([(<span class="string">&#x27;extra_trees&#x27;</span>, ExtraTreesClassifier(n_estimators=<span class="number">100</span>, random_state=<span class="number">42</span>))])</span><br><span class="line">clf_3 = Pipeline([(<span class="string">&#x27;scaler&#x27;</span>, StandardScaler()), (<span class="string">&#x27;mlp&#x27;</span>, MLPClassifier(random_state=<span class="number">42</span>))])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.è®­ç»ƒä¸åŒåˆ†ç±»å™¨</span></span><br><span class="line">estimators = [clf_1, clf_2, clf_3]</span><br><span class="line"><span class="keyword">for</span> estimator <span class="keyword">in</span> estimators:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Training the&quot;</span>, estimator[-<span class="number">1</span>])</span><br><span class="line">    estimator.fit(X_train, y_train)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-&#x27;</span> * <span class="number">63</span>)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="comment"># 4.éªŒè¯é›†ä¸Šè¯„ä¼°å„åˆ†ç±»å™¨</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æ¯ä¸ªåˆ†ç±»å™¨åœ¨éªŒè¯é›†ä¸Šçš„å‡†ç¡®ç‡ï¼š<span class="subst">&#123;[estimator.score(X_val, y_val) <span class="keyword">for</span> estimator <span class="keyword">in</span> estimators]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-&#x27;</span> * <span class="number">63</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.æ„å»º Voting åˆ†ç±»å™¨</span></span><br><span class="line">voting_clf = VotingClassifier([</span><br><span class="line">    (<span class="string">&quot;random_forest&quot;</span>, clf_1),</span><br><span class="line">    (<span class="string">&quot;extra_trees&quot;</span>, clf_2),</span><br><span class="line">    (<span class="string">&quot;mlp&quot;</span>, clf_3)], </span><br><span class="line">    voting=<span class="string">&#x27;hard&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">voting_clf.fit(X_train, y_train)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Voting åˆ†ç±»å™¨åœ¨éªŒè¯é›†ä¸Šçš„å‡†ç¡®ç‡ï¼š<span class="subst">&#123;voting_clf.score(X_val, y_val)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Voting åˆ†ç±»å™¨ä¸­æ¯ä¸ªå­åˆ†ç±»å™¨åœ¨éªŒè¯é›†ä¸Šçš„å‡†ç¡®ç‡ï¼š<span class="subst">&#123;[estimator.score(X_val, y_val) <span class="keyword">for</span> estimator <span class="keyword">in</span> voting_clf.estimators_]&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>é™ç»´åï¼Œæ•°æ®é›†ç»´æ•°ï¼š87
---------------------------------------------------------------
Training the RandomForestClassifier(random_state=42)
Training the ExtraTreesClassifier(random_state=42)
Training the MLPClassifier(random_state=42)
---------------------------------------------------------------
æ¯ä¸ªåˆ†ç±»å™¨åœ¨éªŒè¯é›†ä¸Šçš„å‡†ç¡®ç‡ï¼š[0.9692, 0.9715, 0.9747]
---------------------------------------------------------------
Voting åˆ†ç±»å™¨åœ¨éªŒè¯é›†ä¸Šçš„å‡†ç¡®ç‡ï¼š0.9751
Voting åˆ†ç±»å™¨ä¸­æ¯ä¸ªå­åˆ†ç±»å™¨åœ¨éªŒè¯é›†ä¸Šçš„å‡†ç¡®ç‡ï¼š[0.9692, 0.9715, 0.9747]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 6.å°è¯•è½¯æŠ•ç¥¨çš„å‡†ç¡®ç‡</span></span><br><span class="line">voting_clf.voting = <span class="string">&quot;soft&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;è½¯æŠ•ç¥¨åˆ†ç±»å™¨çš„éªŒè¯å‡†ç¡®ç‡ï¼š<span class="subst">&#123;voting_clf.score(X_val, y_val)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-&#x27;</span> * <span class="number">63</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 7.åœ¨æµ‹è¯•é›†ä¸Šå„åˆ†ç±»å™¨çš„å‡†ç¡®ç‡</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;è½¯æŠ•ç¥¨åˆ†ç±»å™¨åœ¨æµ‹è¯•é›†ä¸Šçš„å‡†ç¡®ç‡ï¼š<span class="subst">&#123;voting_clf.score(X_test, y_test)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;å„å­åˆ†ç±»å™¨åœ¨æµ‹è¯•é›†ä¸Šçš„å‡†ç¡®ç‡ï¼š<span class="subst">&#123;[estimator.score(X_test, y_test) <span class="keyword">for</span> estimator <span class="keyword">in</span> voting_clf.estimators_]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-&#x27;</span> * <span class="number">63</span>)</span><br></pre></td></tr></table></figure>
<pre><code>è½¯æŠ•ç¥¨åˆ†ç±»å™¨çš„éªŒè¯å‡†ç¡®ç‡ï¼š0.9783
---------------------------------------------------------------
è½¯æŠ•ç¥¨åˆ†ç±»å™¨åœ¨æµ‹è¯•é›†ä¸Šçš„å‡†ç¡®ç‡ï¼š0.9757
å„å­åˆ†ç±»å™¨åœ¨æµ‹è¯•é›†ä¸Šçš„å‡†ç¡®ç‡ï¼š[0.9645, 0.9691, 0.9719]
---------------------------------------------------------------
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 8.ä½¿ç”¨ä¸Šè¿°å­åˆ†ç±»å™¨åœ¨éªŒè¯é›†ä¸Šè¿›è¡Œé¢„æµ‹ï¼Œç”±æ­¤å¾—åˆ°ä¸€ä¸ªæ–°è®­ç»ƒé›†</span></span><br><span class="line">X_val_predictions = np.empty(shape=(<span class="built_in">len</span>(X_val), <span class="built_in">len</span>(estimators)), dtype=np.float32)</span><br><span class="line"><span class="keyword">for</span> index, estimator <span class="keyword">in</span> <span class="built_in">enumerate</span>(estimators):</span><br><span class="line">    X_val_predictions[:, index] = estimator.predict(X_val)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="comment"># 9.åœ¨ä¸Šè¿°æ–°è®­ç»ƒé›†ä¸Šï¼Œè®­ç»ƒå…ƒå­¦ä¹ å™¨</span></span><br><span class="line">blender_1 = Pipeline([</span><br><span class="line">    (<span class="string">&#x27;sclaer&#x27;</span>, StandardScaler()), </span><br><span class="line">    (<span class="string">&#x27;LR&#x27;</span>, LogisticRegression(max_iter=<span class="number">10000</span>))</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">blender_2 = Pipeline([</span><br><span class="line">    (<span class="string">&#x27;sclaer&#x27;</span>, StandardScaler()), </span><br><span class="line">    (<span class="string">&#x27;SVC&#x27;</span>, SVC())</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">blender_3 = Pipeline([</span><br><span class="line">    (<span class="string">&#x27;RF&#x27;</span>, RandomForestClassifier(max_depth=<span class="number">5</span>, n_estimators=<span class="number">500</span>, random_state=<span class="number">42</span>))</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">blender_4 = Pipeline([</span><br><span class="line">    (<span class="string">&#x27;GradientBoosting&#x27;</span>, GradientBoostingClassifier(max_depth=<span class="number">5</span>, n_estimators=<span class="number">500</span>, random_state=<span class="number">42</span>))</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">blender_5 = Pipeline([</span><br><span class="line">    (<span class="string">&#x27;sclaer&#x27;</span>, StandardScaler()), </span><br><span class="line">    (<span class="string">&#x27;MLP&#x27;</span>, MLPClassifier(hidden_layer_sizes=(<span class="number">30</span>, ), max_iter=<span class="number">10000</span>, random_state=<span class="number">42</span>))</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 10.é€šè¿‡äº¤å‰éªŒè¯ï¼Œé€‰æ‹©æœ€å¥½çš„å…ƒå­¦ä¹ å™¨</span></span><br><span class="line"><span class="keyword">for</span> blender <span class="keyword">in</span> [blender_1, blender_2, blender_3, blender_4, blender_5]:</span><br><span class="line">    cv_scores = cross_val_score(blender, X_val_predictions, y_val, cv=<span class="number">4</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ğŸ¬<span class="subst">&#123;blender[-<span class="number">1</span>]&#125;</span> çš„äº¤å‰éªŒè¯å‡†ç¡®ç‡ä¸ºï¼š<span class="subst">&#123;<span class="built_in">round</span>(cv_scores.mean(), <span class="number">3</span>)&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>ğŸ¬LogisticRegression(max_iter=10000) çš„äº¤å‰éªŒè¯å‡†ç¡®ç‡ä¸ºï¼š0.959
ğŸ¬SVC() çš„äº¤å‰éªŒè¯å‡†ç¡®ç‡ä¸ºï¼š0.966
ğŸ¬RandomForestClassifier(max_depth=5, n_estimators=500, random_state=42) çš„äº¤å‰éªŒè¯å‡†ç¡®ç‡ä¸ºï¼š0.976
ğŸ¬GradientBoostingClassifier(max_depth=5, n_estimators=500, random_state=42) çš„äº¤å‰éªŒè¯å‡†ç¡®ç‡ä¸ºï¼š0.975
ğŸ¬MLPClassifier(hidden_layer_sizes=(30,), max_iter=10000, random_state=42) çš„äº¤å‰éªŒè¯å‡†ç¡®ç‡ä¸ºï¼š0.972
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 11.æ‹Ÿåˆæœ€ä½³ Blender</span></span><br><span class="line">blender_3.fit(X_val_predictions, y_val)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 12.åŸºäºæœ€ä½³ Blender ç»™å‡º Stacking æ¨¡å‹çš„é¢„æµ‹</span></span><br><span class="line">X_test_predictions = np.empty((<span class="built_in">len</span>(X_test), <span class="built_in">len</span>(estimators)), dtype=np.float32)</span><br><span class="line"><span class="keyword">for</span> index, estimator <span class="keyword">in</span> <span class="built_in">enumerate</span>(estimators):</span><br><span class="line">    X_test_predictions[:, index] = estimator.predict(X_test)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 12.è¯„ä¼° Stacking æ¨¡å‹çš„é¢„æµ‹å‡†ç¡®ç‡</span></span><br><span class="line">y_pred = blender_3.predict(X_test_predictions)    <span class="comment"># è¡¨ç°æœ€å¥½çš„ blender</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Stacking æ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šçš„å‡†ç¡®ç‡ï¼š<span class="subst">&#123;accuracy_score(y_test, y_pred)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Stacking ä¸­çš„å„åŸºåˆ†ç±»å™¨åœ¨æµ‹è¯•é›†ä¸Šçš„å‡†ç¡®ç‡ï¼š<span class="subst">&#123;[estimator.score(X_test, y_test) <span class="keyword">for</span> estimator <span class="keyword">in</span> estimators]&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>Stacking æ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šçš„å‡†ç¡®ç‡ï¼š0.9717
Stacking ä¸­çš„å„åŸºåˆ†ç±»å™¨åœ¨æµ‹è¯•é›†ä¸Šçš„å‡†ç¡®ç‡ï¼š[0.9645, 0.9691, 0.9719]
</code></pre><p>Remarkï¼š</p>
<pre><code>  1. æœ¬ä¾‹ä¸­ï¼ŒVoting æ¨¡å‹åœ¨æ³›åŒ–æ€§èƒ½ä¸Šç•¥ä¼˜äº Stacking æ¨¡å‹
  2. Stacking æ¨¡å‹çš„æ³›åŒ–æ€§èƒ½ç”šè‡³ä½äºæœ€ä½³åŸºåˆ†ç±»å™¨ (MLPClassifier) çš„æ³›åŒ–æ€§èƒ½
  3. æ•°æ®é›†åˆ’åˆ†æŒ‰ç…§ label è¿›è¡Œåˆ†å±‚æŠ½æ ·æ›´åˆç†
  4. åŸºåˆ†ç±»å™¨å’Œå…ƒå­¦ä¹ å™¨éƒ½æ²¡æœ‰ç»è¿‡è¶…å‚ä¼˜åŒ–ï¼Œè¿™å¯¼è‡´æœ€ç»ˆçš„ Voting &amp; Stacking æ¨¡å‹éƒ½æœªå¿…æ˜¯æœ€ä¼˜çš„
</code></pre>
    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Machine-Learning/" rel="tag"># Machine Learning</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/05/03/Better-Plots-With-pairplot-and-PairGrid/" rel="prev" title="Better Plots With pairplot and PairGrid">
                  <i class="fa fa-chevron-left"></i> Better Plots With pairplot and PairGrid
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/05/14/%E3%80%90%E7%AC%94%E8%AE%B0%E3%80%91%E6%95%B0%E5%AD%A6%E5%88%86%E6%9E%90%E6%96%B0%E8%AE%B2-%E7%AC%AC1%E7%AF%87/" rel="next" title="ã€ç¬”è®°ã€‘æ•°å­¦åˆ†ææ–°è®²-ç¬¬1ç¯‡">
                  ã€ç¬”è®°ã€‘æ•°å­¦åˆ†ææ–°è®²-ç¬¬1ç¯‡ <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2021 â€“ 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Gozen Sanji</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
